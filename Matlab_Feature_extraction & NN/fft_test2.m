clc;
clear;
FWHM=50e-12;
%高斯信号FWHM宽度，为50ps
time_window=100*FWHM;
%高斯信号的采样窗口宽度，该值决定了傅里叶变换后的频率分辨率
Ns=2048;
%采样点
dt=time_window/(Ns-1);
%采样时间间隔
t=0:dt:time_window;
%采样时间
%gauss_time=exp(-0.5*(2*sqrt(2*log(2))*(t-2.5e-9)/FWHM).^2);
gauss_time=cos(2*pi.*t/FWHM/10)+wgn(1,Ns,20);

%高斯脉冲，中心位于2.5ns处。
plot(t*1e+9,gauss_time,'linewidth',2.5);
xlabel('Time/ns');
ylabel('Amplitude/V');
title('Gauss pulse');
gauss_spec=fftshift(fft(ifftshift(gauss_time))); 
%傅里叶变换，并且进行fftshift移位操作。
gauss_spec=gauss_spec/Ns; 
%求实际的幅度值；
df=1/time_window;
%频率分辨率
k=floor(-(Ns-1)/2:(Ns-1)/2);
double_f=k*df;
%双边频谱对应的频点
figure;%功率谱密度
double_power_specD_W=abs(gauss_spec).^2/(df);
%双边功率谱密度，单位W/Hz
double_power_specD_mW=double_power_specD_W*1e+3;
%双边功率谱密度，单位mW/Hz
double_power_specD_dBm=10*log10(double_power_specD_mW);
%双边功率谱密度，单位dBm/Hz
plot(double_f*1e-9,double_power_specD_dBm,'linewidth',2.5);
xlabel('Frequency/GHz');
ylabel('Power/(dBm/Hz)');
title('double power spectrum Density');